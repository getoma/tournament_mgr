{% extends 'base/layout.twig' %}
{% import 'base/form.twig' as form %}

{% block content %}
<h2>Teilnehmer</h2>
<table>
   <thead>
      <tr>
         <th>Aktionen</th>
         <th>Teilnehmer</th>
         {% for category in categories -%}
         <th>{{ category.name }}</th>
         {% endfor -%}
      </tr>
   </thead>
   <tbody>
      {% for participant in participants %}
      <tr>
         <td>
            <a href="{{base_path}}/tournament/{{tournament.id}}/participants/{{ participant.id }}">Bearbeiten</a>
            <form method="POST" action="{{base_path}}/tournament/{{tournament.id}}/participants/{{ participant.id }}/delete">
               <input type="submit" value="Löschen" onclick="return confirm('{{ participant.lastname }}, {{ participant.firstname }} wirklich löschen?');">
            </form>
         </td>
         <td>{{ participant.lastname }}, {{ participant.firstname }}</td>
         {% for category in categories -%}
         <td><input type="checkbox" name="category_{{category.id}}[]" value="{{participant.id}}" title="{{category.name}}" form="participant_list_form"
                {%- if participant.categories[category.id] is defined %} checked{%endif%}></td>
         {% endfor -%}
         </tr>
      {% endfor %}
   </tbody>
</table>
<form method="POST" action="{{base_path}}/tournament/{{ tournament.id }}/participants" id="participant_list_form">
   {{ form.submit('Speichern') }}
</form>

<h2>Teilnehmer hinzufügen</h2>
<form method="POST" action="{{base_path}}/tournament/{{ tournament.id }}/participants/import" id="participant_add_form">
   {{ form.textarea('participants', 'Teilnehmerliste', prev.participants ?? '',  errors.participants, attributes={'rows':10, 'cols': 30}, required=true) }}
   {% for category in categories %}
   {{ form.checkbox('categories[]', category.name, category.id in prev.categories, '', attributes={'value': category.id}) }}
   {% endfor %}
   {{ form.submit('Hinzufügen') }}
</form>

{% endblock %}