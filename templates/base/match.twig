
{% macro printSlot(slot, winner) %}
{% if winner and slot.getParticipant() is same as(winner)%}<em>{%endif%}
{%-if slot.getParticipant()%}{{slot.getParticipant().lastname}}, {{slot.getParticipant().firstname}}
{%-else%}{{slot.str()}}
{%-endif%}
{% if winner and slot.getParticipant() is same as(winner)%}</em>{%endif%}
{% endmacro %}

{% macro printMatch(node) %}
<span class="fight_participant red">{{_self.printSlot(node.slotRed, node.getWinner())}}</span> vs. <span class="fight_participant white">{{_self.printSlot(node.slotWhite, node.getWinner())}}</span>
{% endmacro %}

{% macro printChunkWinner(chunk) %}
{%-if chunk.root.getWinner()%}{{chunk.root.getWinner().lastname}}, {{chunk.root.getWinner().firstname}}
{%-elseif chunk.root.isBye()%}--
{%-else%}Gewinner {{chunk.root.name}}
{%-endif%}
{% endmacro %}

{% macro printKo(ko, chunks, route_param) %}
<ul class="fight_tree">
  {%- if chunks is defined %}
  <li><span class="round_caption">Kampffl√§chen</span>
    <ul class="fight_round">
      {% for name, chunk in chunks %}
      <li><span class="fight_name"><a href="{{ url_for('show_ko_area', route_param|merge({'chunk': name})) }}">Gewinner {{chunk.name}}</a></span>
          <span class="fight_participant">{{_self.printChunkWinner(chunk)}}</span>
      </li>
      {% endfor %}
    </ul>
  </li>
  {% endif %}
  {% for round in ko %}
  <li><span class="round_caption">Runde {{loop.index}}</span>
    <ul class="fight_round">
      {% for node in round %}
      <li><span class="fight_name">
        {%- if node.isReal() %}<a href="{{ url_for('show_ko_match', route_param|merge({'matchName': node.name})) }}">{%endif-%}
          Kampf {{node.name}}{% if node.area is defined %} ({{node.area.name}}){%endif%}
        {%- if node.isReal() %}</a>{% endif -%}
        </span>
        {{ _self.printMatch(node) }}
      </li>
      {% endfor %}
    </ul>
  </li>
  {% endfor %}
</ul>
{% endmacro %}